<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BatchingRPCServer: Serving::TBServer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BatchingRPCServer
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_serving.html">Serving</a></li><li class="navelem"><a class="el" href="class_serving_1_1_t_b_server.html">TBServer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_serving_1_1_t_b_server-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Serving::TBServer Class Reference<span class="mlabels"><span class="mlabel">final</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements the BatchingServer::Service, providing the transport/RPC layer.  
 <a href="class_serving_1_1_t_b_server.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_t_b_server_8hpp_source.html">TBServer.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Serving::TBServer:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_serving_1_1_t_b_server.png" usemap="#Serving::TBServer_map" alt=""/>
  <map id="Serving::TBServer_map" name="Serving::TBServer_map">
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab8358a329b3c0a47740eb068b321a9c1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_serving_1_1_t_b_server.html#ab8358a329b3c0a47740eb068b321a9c1">TBServer</a> (<a class="el" href="class_serving_1_1_servable.html">Servable</a> *servable)</td></tr>
<tr class="memdesc:ab8358a329b3c0a47740eb068b321a9c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructs a new <a class="el" href="class_serving_1_1_t_b_server.html" title="Implements the BatchingServer::Service, providing the transport/RPC layer. ">TBServer</a> object around an already-created <a class="el" href="class_serving_1_1_servable.html" title="Delimits the public API for a Servable object. ">Servable</a>.  <a href="#ab8358a329b3c0a47740eb068b321a9c1">More...</a><br /></td></tr>
<tr class="separator:ab8358a329b3c0a47740eb068b321a9c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e76656953e967b492eb122102b345fe"><td class="memItemLeft" align="right" valign="top"><a id="a9e76656953e967b492eb122102b345fe"></a>
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_serving_1_1_t_b_server.html#a9e76656953e967b492eb122102b345fe">~TBServer</a> () override</td></tr>
<tr class="memdesc:a9e76656953e967b492eb122102b345fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys a <a class="el" href="class_serving_1_1_t_b_server.html" title="Implements the BatchingServer::Service, providing the transport/RPC layer. ">TBServer</a> object and cleans up all resources. <br /></td></tr>
<tr class="separator:a9e76656953e967b492eb122102b345fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e3a0c0928ceb6581321c847c319b886"><td class="memItemLeft" align="right" valign="top">grpc::Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_serving_1_1_t_b_server.html#a2e3a0c0928ceb6581321c847c319b886">SetBatchSize</a> (grpc::ServerContext *ctx, const AdminRequest *req, AdminReply *rep) override</td></tr>
<tr class="memdesc:a2e3a0c0928ceb6581321c847c319b886"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the gRPC backend for setting the batch size of the <a class="el" href="class_serving_1_1_servable.html" title="Delimits the public API for a Servable object. ">Servable</a> object. The client API for this function can be found in BatchingRPC.proto.  <a href="#a2e3a0c0928ceb6581321c847c319b886">More...</a><br /></td></tr>
<tr class="separator:a2e3a0c0928ceb6581321c847c319b886"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72b1c69cbbfbacd2b428d4b158646e43"><td class="memItemLeft" align="right" valign="top">grpc::Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_serving_1_1_t_b_server.html#a72b1c69cbbfbacd2b428d4b158646e43">Connect</a> (grpc::ServerContext *ctx, const ConnectionRequest *req, ConnectionReply *rep) override</td></tr>
<tr class="memdesc:a72b1c69cbbfbacd2b428d4b158646e43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the gRPC backend for creating a new connection to the <a class="el" href="class_serving_1_1_servable.html" title="Delimits the public API for a Servable object. ">Servable</a>. The client API for this function can be found in BatchingRPC.proto.  <a href="#a72b1c69cbbfbacd2b428d4b158646e43">More...</a><br /></td></tr>
<tr class="separator:a72b1c69cbbfbacd2b428d4b158646e43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d50db8996b97e48d355312e736573cc"><td class="memItemLeft" align="right" valign="top">grpc::Status&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_serving_1_1_t_b_server.html#a8d50db8996b97e48d355312e736573cc">Process</a> (grpc::ServerContext *ctx, const TensorMessage *req, TensorMessage *rep) override</td></tr>
<tr class="memdesc:a8d50db8996b97e48d355312e736573cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Defines the gRPC backend for requesting the <a class="el" href="class_serving_1_1_servable.html" title="Delimits the public API for a Servable object. ">Servable</a> process some piece of data. The client API for this function can be found in BatchingRPC.proto.  <a href="#a8d50db8996b97e48d355312e736573cc">More...</a><br /></td></tr>
<tr class="separator:a8d50db8996b97e48d355312e736573cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24482b8d15d9cff91ab3f6b617aec552"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_serving_1_1_t_b_server.html#a24482b8d15d9cff91ab3f6b617aec552">StartInsecure</a> (const std::string &amp;server_address)</td></tr>
<tr class="memdesc:a24482b8d15d9cff91ab3f6b617aec552"><td class="mdescLeft">&#160;</td><td class="mdescRight">Starts the server at the specified address.  <a href="#a24482b8d15d9cff91ab3f6b617aec552">More...</a><br /></td></tr>
<tr class="separator:a24482b8d15d9cff91ab3f6b617aec552"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e83eab2f062e4c486185e65870c726b"><td class="memItemLeft" align="right" valign="top"><a id="a4e83eab2f062e4c486185e65870c726b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_serving_1_1_t_b_server.html#a4e83eab2f062e4c486185e65870c726b">Stop</a> ()</td></tr>
<tr class="memdesc:a4e83eab2f062e4c486185e65870c726b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Shuts down the server and cleans up used resources. <br /></td></tr>
<tr class="separator:a4e83eab2f062e4c486185e65870c726b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements the BatchingServer::Service, providing the transport/RPC layer. </p>
<p>This class provides the transport/RPC layer to the project. This means that if we implement a <a class="el" href="class_serving_1_1_servable.html" title="Delimits the public API for a Servable object. ">Servable</a> object, we can use this class to serve requests to it. The API for the <a class="el" href="class_serving_1_1_servable.html" title="Delimits the public API for a Servable object. ">Servable</a> object can be found in <a class="el" href="_servable_8hpp_source.html">Servable.hpp</a> and the API for this object can be found in BatchingRPC.proto. Requests to the system as a whole must follow the API in BatchingRPC.proto and internal requests from <a class="el" href="class_serving_1_1_t_b_server.html" title="Implements the BatchingServer::Service, providing the transport/RPC layer. ">TBServer</a> to an implementation of a <a class="el" href="class_serving_1_1_servable.html" title="Delimits the public API for a Servable object. ">Servable</a> must follow the API in <a class="el" href="_servable_8hpp_source.html">Servable.hpp</a>. </p>

<p class="definition">Definition at line <a class="el" href="_t_b_server_8hpp_source.html#l00063">63</a> of file <a class="el" href="_t_b_server_8hpp_source.html">TBServer.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ab8358a329b3c0a47740eb068b321a9c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8358a329b3c0a47740eb068b321a9c1">&#9670;&nbsp;</a></span>TBServer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Serving::TBServer::TBServer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_serving_1_1_servable.html">Servable</a> *&#160;</td>
          <td class="paramname"><em>servable</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructs a new <a class="el" href="class_serving_1_1_t_b_server.html" title="Implements the BatchingServer::Service, providing the transport/RPC layer. ">TBServer</a> object around an already-created <a class="el" href="class_serving_1_1_servable.html" title="Delimits the public API for a Servable object. ">Servable</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">servable</td><td>A pointer to an initialized <a class="el" href="class_serving_1_1_servable.html" title="Delimits the public API for a Servable object. ">Servable</a> object. Takes ownership of the pointer upon construction. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_t_b_server_8cpp_source.html#l00036">36</a> of file <a class="el" href="_t_b_server_8cpp_source.html">TBServer.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a72b1c69cbbfbacd2b428d4b158646e43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72b1c69cbbfbacd2b428d4b158646e43">&#9670;&nbsp;</a></span>Connect()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Status Serving::TBServer::Connect </td>
          <td>(</td>
          <td class="paramtype">grpc::ServerContext *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const ConnectionRequest *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ConnectionReply *&#160;</td>
          <td class="paramname"><em>rep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Defines the gRPC backend for creating a new connection to the <a class="el" href="class_serving_1_1_servable.html" title="Delimits the public API for a Servable object. ">Servable</a>. The client API for this function can be found in BatchingRPC.proto. </p>
<p>This function creates a uuid for each client to avoid client id collisions in the servable's processing space. The client should call this function once, receive their unique ID, and tag all future requests to Process with this unique ID. This function can be called as often as desired.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td></td></tr>
    <tr><td class="paramname">req</td><td></td></tr>
    <tr><td class="paramname">rep</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>gRPC status to the client. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_t_b_server_8cpp_source.html#l00060">60</a> of file <a class="el" href="_t_b_server_8cpp_source.html">TBServer.cpp</a>.</p>

</div>
</div>
<a id="a8d50db8996b97e48d355312e736573cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d50db8996b97e48d355312e736573cc">&#9670;&nbsp;</a></span>Process()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">grpc::Status Serving::TBServer::Process </td>
          <td>(</td>
          <td class="paramtype">grpc::ServerContext *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const TensorMessage *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TensorMessage *&#160;</td>
          <td class="paramname"><em>rep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Defines the gRPC backend for requesting the <a class="el" href="class_serving_1_1_servable.html" title="Delimits the public API for a Servable object. ">Servable</a> process some piece of data. The client API for this function can be found in BatchingRPC.proto. </p>
<p>This function enqueues a request to the <a class="el" href="class_serving_1_1_servable.html" title="Delimits the public API for a Servable object. ">Servable</a> for both data processing and retreival of results. This function will block until the current batch is finished processing. The client is free to call Process in another thread and simply wait for the result, or use an std::async call to wait for the result as the client wishes. An example of calling this function in a somewhat asynchronous manner can be found in <a class="el" href="_test_integration_8cpp_source.html">TestIntegration.cpp</a></p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td></td></tr>
    <tr><td class="paramname">req</td><td></td></tr>
    <tr><td class="paramname">rep</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>gRPC status to the client. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_t_b_server_8cpp_source.html#l00073">73</a> of file <a class="el" href="_t_b_server_8cpp_source.html">TBServer.cpp</a>.</p>

</div>
</div>
<a id="a2e3a0c0928ceb6581321c847c319b886"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e3a0c0928ceb6581321c847c319b886">&#9670;&nbsp;</a></span>SetBatchSize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">grpc::Status Serving::TBServer::SetBatchSize </td>
          <td>(</td>
          <td class="paramtype">grpc::ServerContext *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const AdminRequest *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">AdminReply *&#160;</td>
          <td class="paramname"><em>rep</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Defines the gRPC backend for setting the batch size of the <a class="el" href="class_serving_1_1_servable.html" title="Delimits the public API for a Servable object. ">Servable</a> object. The client API for this function can be found in BatchingRPC.proto. </p>
<p>This function calls <a class="el" href="class_serving_1_1_servable.html#ab22dd1fb4679d8e7ab2e9ad74280ac52" title="Sets the batch size of the Servable. ">Serving::Servable::SetBatchSize</a>, which can return two states. If an attempt is made to set the batch size to be smaller than the current size of the batch, then Serving::ReturnCodes::NEXT_BATCH is returned, indicating that the request should be retried. If the request is successful, Serving::ReturnCodes::OK will be returned and the call can proceed as normal. This call blocks on input aggregation and processing of the current batch.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td></td></tr>
    <tr><td class="paramname">req</td><td></td></tr>
    <tr><td class="paramname">rep</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>gRPC status to the client. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_t_b_server_8cpp_source.html#l00046">46</a> of file <a class="el" href="_t_b_server_8cpp_source.html">TBServer.cpp</a>.</p>

</div>
</div>
<a id="a24482b8d15d9cff91ab3f6b617aec552"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24482b8d15d9cff91ab3f6b617aec552">&#9670;&nbsp;</a></span>StartInsecure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Serving::TBServer::StartInsecure </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>server_address</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Starts the server at the specified address. </p>
<p>Hides the gRPC server starting code behind a convenient function that can be called to start the server with the credentials specified in the function name.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">server_address</td><td>Specifies the server's address - for example:<div class="fragment"><div class="line"><span class="stringliteral">&quot;127.0.0.1:8080&quot;</span> </div></div><!-- fragment --> </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_t_b_server_8cpp_source.html#l00118">118</a> of file <a class="el" href="_t_b_server_8cpp_source.html">TBServer.cpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="_t_b_server_8hpp_source.html">TBServer.hpp</a></li>
<li><a class="el" href="_t_b_server_8cpp_source.html">TBServer.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
